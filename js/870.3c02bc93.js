"use strict";(self["webpackChunknon_guide"]=self["webpackChunknon_guide"]||[]).push([[870],{6870:function(e,t,n){n.r(t),n.d(t,{default:function(){return K}});var a=n(3396),o=n(7139),l=n(9242);const s={class:"row gx-2"},r=(0,a._)("h3",{class:"fs-5"}," 聯絡資訊 ",-1),i={class:"col-12 mb-4"},c={class:"form-floating"},d=(0,a._)("label",{for:"checkoutInputMail","aria-label":"電子郵箱位置"},"電子郵箱位置",-1),u=(0,a._)("h3",{class:"fs-5"}," 寄件地址 ",-1),m={class:"col-md-6 mb-2"},f={class:"form-floating"},p=(0,a._)("label",{for:"checkoutInputName","aria-label":"收件人姓名"},"收件人姓名",-1),h={class:"col-md-6 mb-2"},g={class:"form-floating"},b=(0,a._)("label",{for:"checkoutInputMobile","aria-label":"收件人行動電話"},"收件人行動電話",-1),v={class:"col-md-6 mb-2"},y={class:"form-floating"},w={id:"counties"},_=["value"],V=(0,a._)("label",{for:"checkoutInputCounty","aria-label":"縣市"},"縣市",-1),C={class:"col-md-6 mb-2"},k={class:"form-floating"},x={id:"towns"},S=["value"],T=(0,a._)("label",{for:"checkoutInputTown","aria-label":"鄉鎮市區"},"鄉鎮市區",-1),A={class:"col-12 mb-4"},M={class:"form-floating"},O=(0,a._)("label",{for:"checkoutInputAddress","aria-label":"街道（巷弄）門牌號（樓層）"},"街道（巷弄）門牌號（樓層）",-1),I=(0,a._)("h3",{class:"fs-5 d-none d-md-block"}," 備註 ",-1),N={class:"col-12 mb-4 d-none d-md-block"},W={class:"form-floating"},D=(0,a._)("label",{for:"checkoutInputNote"},"（選填）",-1),j=(0,a._)("div",{class:"col-md-6 mb-4 order-md-2"},[(0,a._)("button",{type:"submit",class:"btn btn-primary btn-lg w-100"}," 繼續結帳 ")],-1),X={class:"col-md-6 d-flex justify-content-center justify-content-md-start align-items-center mb-4 order-md-1"},L=(0,a._)("i",{class:"bi bi-chevron-left me-1"},null,-1),$=(0,a.Uk)("打開購物車 "),J=[L,$];function U(e,t,n,L,$,U){const q=(0,a.up)("VueLoading"),H=(0,a.up)("VeeField"),E=(0,a.up)("VeeErrorMessage"),z=(0,a.up)("VeeForm"),F=(0,a.up)("CartOffcanvas");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(q,{active:$.isLoading,"is-full-page":!1},null,8,["active"]),(0,a.Wm)(z,{onSubmit:U.submitOrder},{default:(0,a.w5)((({errors:n})=>[(0,a._)("div",s,[r,(0,a._)("div",i,[(0,a._)("div",c,[(0,a.Wm)(H,{id:"checkoutInputMail",modelValue:$.form.user.email,"onUpdate:modelValue":t[0]||(t[0]=e=>$.form.user.email=e),type:"email",class:(0,o.C_)(["form-control",{"is-invalid":n["電子郵箱位址"]}]),name:"電子郵箱位址",rules:"email|required",placeholder:"name@example.com"},null,8,["modelValue","class"]),(0,a.Wm)(E,{name:"電子郵箱位址",class:"invalid-feedback"}),d])]),u,(0,a._)("div",m,[(0,a._)("div",f,[(0,a.Wm)(H,{id:"checkoutInputName",modelValue:$.form.user.name,"onUpdate:modelValue":t[1]||(t[1]=e=>$.form.user.name=e),type:"text",class:(0,o.C_)(["form-control",{"is-invalid":n["收件人姓名"]}]),name:"收件人姓名",rules:"required",placeholder:"姓名"},null,8,["modelValue","class"]),(0,a.Wm)(E,{name:"收件人姓名",class:"invalid-feedback"}),p])]),(0,a._)("div",h,[(0,a._)("div",g,[(0,a.Wm)(H,{id:"checkoutInputMobile",modelValue:$.form.user.tel,"onUpdate:modelValue":t[2]||(t[2]=e=>$.form.user.tel=e),type:"tel",class:(0,o.C_)(["form-control",{"is-invalid":n["收件人行動電話"]}]),name:"收件人行動電話",rules:U.isMobile,placeholder:"0912345678"},null,8,["modelValue","class","rules"]),(0,a.Wm)(E,{name:"收件人行動電話",class:"invalid-feedback"}),b])]),(0,a._)("div",v,[(0,a._)("div",y,[(0,a.Wm)(H,{id:"checkoutInputCounty",modelValue:$.county,"onUpdate:modelValue":t[3]||(t[3]=e=>$.county=e),class:(0,o.C_)(["form-control",{"is-invalid":n["縣市"]}]),name:"縣市",rules:"required",placeholder:"XX市",list:"counties",onChange:U.getTown},null,8,["modelValue","class","onChange"]),(0,a._)("datalist",w,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)($.countyDataArr,(e=>((0,a.wg)(),(0,a.iD)("option",{key:e.countycode,value:e.countyname},(0,o.zw)(e.countyname),9,_)))),128))]),(0,a.Wm)(E,{name:"縣市",class:"invalid-feedback"}),V])]),(0,a._)("div",C,[(0,a._)("div",k,[(0,a.Wm)(H,{id:"checkoutInputTown",modelValue:$.town,"onUpdate:modelValue":t[4]||(t[4]=e=>$.town=e),class:(0,o.C_)(["form-control",{"is-invalid":n["鄉鎮市區"]}]),name:"鄉鎮市區",rules:"required",placeholder:"XX市",list:"towns"},null,8,["modelValue","class"]),(0,a._)("datalist",x,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)($.townDataArr,(e=>((0,a.wg)(),(0,a.iD)("option",{key:e.towncode,value:e.townname},(0,o.zw)(e.townname),9,S)))),128))]),T])]),(0,a._)("div",A,[(0,a._)("div",M,[(0,a.Wm)(H,{id:"checkoutInputAddress",modelValue:$.rawAddress,"onUpdate:modelValue":t[5]||(t[5]=e=>$.rawAddress=e),type:"text",class:(0,o.C_)(["form-control",{"is-invalid":n["街道（巷弄）門牌號（樓層）"]}]),name:"街道（巷弄）門牌號（樓層）",rules:"required",placeholder:"星光大道",onChange:U.combineAddress},null,8,["modelValue","class","onChange"]),(0,a.Wm)(E,{name:"街道（巷弄）門牌號（樓層）",class:"invalid-feedback"}),O])]),I,(0,a._)("div",N,[(0,a._)("div",W,[(0,a.Wm)(H,{id:"checkoutInputNote",modelValue:$.form.message,"onUpdate:modelValue":t[6]||(t[6]=e=>$.form.message=e),as:"textarea",class:"form-control",name:"備註",placeholder:"Leave a comment here"},null,8,["modelValue"]),D])]),j,(0,a._)("div",X,[(0,a._)("a",{href:"#",class:"text-decoration-none",onClick:t[7]||(t[7]=(0,l.iM)((t=>e.$refs.cartOffcanvas.showOffcanvas()),["prevent"]))},J)])])])),_:1},8,["onSubmit"]),(0,a.Wm)(F,{ref:"cartOffcanvas"},null,512)],64)}var q=n(7449);function H(e){var t=null;if(window.DOMParser)try{t=(new DOMParser).parseFromString(e,"text/xml")}catch(n){t=null}else if(window.ActiveXObject)try{t=new ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.loadXML(e)||window.alert(t.parseError.reason+t.parseError.srcText)}catch(n){t=null}else alert("oops");return t}function E(e,t){var n={toObj:function(e){var t={};if(1==e.nodeType){if(e.attributes.length)for(var a=0;a<e.attributes.length;a++)t["@"+e.attributes[a].nodeName]=(e.attributes[a].nodeValue||"").toString();if(e.firstChild){for(var o=0,l=0,s=!1,r=e.firstChild;r;r=r.nextSibling)1==r.nodeType?s=!0:3==r.nodeType&&r.nodeValue.match(/[^ \f\n\r\t\v]/)?o++:4==r.nodeType&&l++;if(s)if(o<2&&l<2){n.removeWhite(e);for(r=e.firstChild;r;r=r.nextSibling)3==r.nodeType?t["#text"]=n.escape(r.nodeValue):4==r.nodeType?t["#cdata"]=n.escape(r.nodeValue):t[r.nodeName]?t[r.nodeName]instanceof Array?t[r.nodeName][t[r.nodeName].length]=n.toObj(r):t[r.nodeName]=[t[r.nodeName],n.toObj(r)]:t[r.nodeName]=n.toObj(r)}else e.attributes.length?t["#text"]=n.escape(n.innerXml(e)):t=n.escape(n.innerXml(e));else if(o)e.attributes.length?t["#text"]=n.escape(n.innerXml(e)):t=n.escape(n.innerXml(e));else if(l)if(l>1)t=n.escape(n.innerXml(e));else for(r=e.firstChild;r;r=r.nextSibling)t["#cdata"]=n.escape(r.nodeValue)}e.attributes.length||e.firstChild||(t=null)}else 9==e.nodeType?t=n.toObj(e.documentElement):alert("unhandled node type: "+e.nodeType);return t},toJson:function(e,t,a){var o=t?'"'+t+'"':"";if(e instanceof Array){for(var l=0,s=e.length;l<s;l++)e[l]=n.toJson(e[l],"",a+"\t");o+=(t?":[":"[")+(e.length>1?"\n"+a+"\t"+e.join(",\n"+a+"\t")+"\n"+a:e.join(""))+"]"}else if(null==e)o+=(t&&":")+"null";else if("object"==typeof e){var r=[];for(var i in e)r[r.length]=n.toJson(e[i],i,a+"\t");o+=(t?":{":"{")+(r.length>1?"\n"+a+"\t"+r.join(",\n"+a+"\t")+"\n"+a:r.join(""))+"}"}else o+="string"==typeof e?(t&&":")+'"'+e.toString()+'"':(t&&":")+e.toString();return o},innerXml:function(e){var t="";if("innerHTML"in e)t=e.innerHTML;else for(var n=function(e){var t="";if(1==e.nodeType){t+="<"+e.nodeName;for(var a=0;a<e.attributes.length;a++)t+=" "+e.attributes[a].nodeName+'="'+(e.attributes[a].nodeValue||"").toString()+'"';if(e.firstChild){t+=">";for(var o=e.firstChild;o;o=o.nextSibling)t+=n(o);t+="</"+e.nodeName+">"}else t+="/>"}else 3==e.nodeType?t+=e.nodeValue:4==e.nodeType&&(t+="<![CDATA["+e.nodeValue+"]]>");return t},a=e.firstChild;a;a=a.nextSibling)t+=n(a);return t},escape:function(e){return e.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(e){e.normalize();for(var t=e.firstChild;t;)if(3==t.nodeType)if(t.nodeValue.match(/[^ \f\n\r\t\v]/))t=t.nextSibling;else{var a=t.nextSibling;e.removeChild(t),t=a}else 1==t.nodeType?(n.removeWhite(t),t=t.nextSibling):t=t.nextSibling;return e}};9==e.nodeType&&(e=e.documentElement);var a=n.toJson(n.toObj(n.removeWhite(e)),e.nodeName,"\t");return"{\n"+t+(t?a.replace(/\t/g,t):a.replace(/\t|\n/g,""))+"\n}"}var z={components:{CartOffcanvas:q.Z},inject:["$emitter","$pushMessageState"],data(){return{form:{user:{name:"",email:"",tel:"",address:""},message:""},county:"",town:"",rawAddress:"",countyDataArr:[],townDataArr:[],isLoading:!1}},created(){this.getCounty()},methods:{isMobile(e){const t=/^(09)[0-9]{8}$/;return!!t.test(e)||"請輸入以「09」開頭的行動電話號碼"},getCounty(){const e="https://api.nlsc.gov.tw/other/ListCounty",t=new XMLHttpRequest;t.open("get",e),t.send(null),t.onload=()=>{if(200===t.status){const e=JSON.parse(E(H(t.responseText),""));this.countyDataArr=e.countyItems.countyItem}else t.data={},this.$pushMessageState(t,"取得縣市清單")}},getTown(){const e=this.countyDataArr.findIndex((e=>e.countyname===this.county));if(this.townDataArr=[],e>=0){const t=this.countyDataArr[e].countycode,n=`https://api.nlsc.gov.tw/other/ListTown/${t}`,a=new XMLHttpRequest;a.open("get",n),a.send(null),a.onload=()=>{if(200===a.status){const e=JSON.parse(E(H(a.responseText),""));this.townDataArr=e.townItems.townItem}else a.data={},this.$pushMessageState(a,"取得鄉鎮市區清單")}}},combineAddress(){this.form.user.address=this.county+this.town+this.rawAddress},submitOrder(){this.isLoading=!0;const e="https://vue3-course-api.hexschool.io/api/vue3-final/order",t=JSON.parse(JSON.stringify(this.form));this.$http.post(e,{data:t}).then((e=>{e.data.success?this.$router.push(`/checkout/${e.data.orderId}`):this.$pushMessageState(e,"建立訂單")})).catch((e=>{this.$pushMessageState(e.response,"建立訂單")})).finally((()=>{this.isLoading=!1}))}}},F=n(89);const Y=(0,F.Z)(z,[["render",U]]);var K=Y}}]);
//# sourceMappingURL=870.3c02bc93.js.map